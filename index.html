<!DOCTYPE html>
<html lang="es">
<head>
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"SoftwareSourceCode",
    "name":"SigmaPredictor_TCDS",
    "alternateName": "Sistema Predictivo Sísmico TCDS — Análisis coherencial basado en el campo Σ",
    "description":"Motor de métricas Σ (LI, R, RMSE_SL, κΣ) para auditoría forense y predicción de series temporales. Implementación oficial del OmniKernel TCDS.",
    "url":"https://geozunac3536-jpg.github.io/Las-Sigma-Metrics/",
    "codeRepository":"https://github.com/geozunac3536-jpg/Las-Sigma-Metrics",
    "programmingLanguage":"Python",
    "license":"https://opensource.org/licenses/MIT",
    "softwareVersion":"v1.1.0",
    "identifier": "10.5281/zenodo.17526187",
    "author":{"@type":"Person","name":"Genaro Carrasco Ozuna","identifier":"https://orcid.org/0009-0005-6358-9910","affiliation":"TCDS OmniKernel Project"},
    "keywords":["TCDS","Phase Locking","Forensic Audit","Seismic Prediction","Python","Termux","LBCU"]
  }
  </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#050505">
  <meta name="robots" content="index, follow">
  <title>SigmaMetrics TCDS | Dashboard de Telemetría</title>
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #050505; 
      --panel: #0a0c10; 
      --border: #1e2329;
      --text-main: #e6edf3; 
      --text-dim: #8b949e;
      --accent-cyan: #00f0ff; 
      --accent-red: #ff2a6d; 
      --accent-green: #05d5aa;
      --font-ui: 'Inter', sans-serif;
      --font-code: 'JetBrains Mono', monospace;
    }

    body { margin: 0; font-family: var(--font-ui); background: var(--bg); color: var(--text-main); line-height: 1.6; }
    
    /* ESTRUCTURA */
    .container { max-width: 1100px; margin: 0 auto; padding: 40px 20px; }
    
    /* HEADER TÁCTICO */
    header { text-align: center; margin-bottom: 40px; border-bottom: 1px solid var(--border); padding-bottom: 30px; }
    h1 { font-family: var(--font-code); font-size: 2.5rem; margin: 0; letter-spacing: -1px; background: linear-gradient(90deg, #fff, #8b949e); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .subtitle { color: var(--accent-cyan); font-family: var(--font-code); font-size: 0.9rem; letter-spacing: 2px; text-transform: uppercase; margin-top: 10px; }
    .badges { margin-top: 15px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; }
    .badges img { height: 24px; transition: transform 0.2s; }
    .badges img:hover { transform: scale(1.05); }

    /* GRID DASHBOARD */
    .dashboard-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-top: 30px; }
    @media (max-width: 768px) { .dashboard-grid { grid-template-columns: 1fr; } }

    /* TARJETAS (CARDS) */
    .card { background: var(--panel); border: 1px solid var(--border); border-radius: 8px; padding: 24px; box-shadow: 0 4px 20px rgba(0,0,0,0.4); position: relative; overflow: hidden; }
    .card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 2px; background: linear-gradient(90deg, var(--accent-cyan), transparent); }
    
    h2 { font-size: 1.1rem; margin: 0 0 20px 0; color: var(--text-dim); text-transform: uppercase; font-family: var(--font-code); display: flex; align-items: center; gap: 10px; }
    h2::before { content: '■'; color: var(--accent-cyan); font-size: 0.8em; }

    /* TABLA DE MÉTRICAS */
    .metrics-display { display: grid; grid-template-columns: 1fr; gap: 15px; }
    .metric-row { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #161b22; padding-bottom: 8px; }
    .metric-name { font-family: var(--font-code); color: var(--text-dim); }
    .metric-value { font-family: var(--font-code); font-weight: 700; font-size: 1.2rem; color: var(--accent-green); }
    .metric-value.alert { color: var(--accent-red); }

    /* CONSOLA / LOGS */
    .console-box { background: #000; border: 1px solid #30363d; padding: 15px; border-radius: 4px; font-family: var(--font-code); font-size: 0.8rem; color: #3fb950; height: 120px; overflow-y: auto; white-space: pre-wrap; margin-top: 20px; scrollbar-width: thin; scrollbar-color: #30363d #000; }
    .console-line { margin-bottom: 4px; border-bottom: 1px dashed #111; }
    .console-time { color: #8b949e; margin-right: 8px; }

    /* BOTONES */
    .actions { display: flex; gap: 15px; margin-top: 40px; justify-content: center; flex-wrap: wrap; }
    .btn { 
      text-decoration: none; padding: 12px 24px; border-radius: 4px; font-family: var(--font-code); font-weight: 700; font-size: 0.9rem; 
      transition: all 0.2s; border: 1px solid transparent; text-transform: uppercase; cursor: pointer;
    }
    .btn-primary { background: var(--accent-cyan); color: #000; box-shadow: 0 0 15px rgba(0, 240, 255, 0.2); }
    .btn-primary:hover { background: #fff; box-shadow: 0 0 25px rgba(0, 240, 255, 0.4); transform: translateY(-2px); }
    .btn-secondary { background: transparent; border: 1px solid var(--border); color: var(--text-main); }
    .btn-secondary:hover { border-color: var(--text-dim); background: rgba(255,255,255,0.05); }

    footer { text-align: center; margin-top: 60px; color: var(--text-dim); font-size: 0.8rem; border-top: 1px solid var(--border); padding-top: 20px; margin-bottom: 40px; }
    footer a { color: var(--accent-cyan); text-decoration: none; }
  </style>
</head>
<body>

  <div class="container">
    
    <header>
      <h1>SIGMA PREDICTOR TCDS</h1>
      <div class="subtitle">OmniKernel Forensic Engine v1.1.0</div>
      
      <div class="badges">
        <a href="https://doi.org/10.5281/zenodo.17526187" target="_blank">
          <img src="https://zenodo.org/badge/DOI/10.5281/zenodo.17526187.svg" alt="DOI">
        </a>
        <img src="https://img.shields.io/badge/TRL--9-OPERATIONAL-05d5aa.svg?style=flat-square" alt="Status">
        <img src="https://img.shields.io/badge/BUILD-PASSING-05d5aa.svg?style=flat-square&logo=githubactions" alt="Build">
        <a href="https://orcid.org/0009-0005-6358-9910" target="_blank">
          <img src="https://img.shields.io/badge/ORCID-VALIDATED-a6ce39.svg?style=flat-square&logo=orcid" alt="ORCID">
        </a>
      </div>
    </header>

    <div class="dashboard-grid">
      
      <div class="card">
        <h2>[A] Telemetría Forense</h2>
        <div class="metrics-display" id="metricsContainer">
          <div class="metric-row"><span class="metric-name">Inicializando sensores...</span></div>
        </div>
        
        <div class="console-box" id="auditLog">
          </div>
      </div>

      <div class="card">
        <h2>[B] Análisis de Coherencia</h2>
        <canvas id="sigmaChart"></canvas>
        <p style="font-size: 0.75rem; color: var(--text-dim); margin-top: 15px; text-align: center; font-family: var(--font-code);">
          *Visualización normalizada del Locking Index (LI) vs Fricción (φ)
        </p>
      </div>

    </div>

    <div class="actions">
      <a href="SigmaPredictor_TCDS_v1.1.0.zip" class="btn btn-primary">⬇ Descargar Core (ZIP)</a>
      <a href="https://github.com/geozunac3536-jpg/Las-Sigma-Metrics" target="_blank" class="btn btn-secondary">Ver Código Fuente</a>
      <a href="CITATION.cff" target="_blank" class="btn btn-secondary">Citar (BibTeX)</a>
    </div>

    <footer>
      <p>GENARO CARRASCO OZUNA © 2025 | PROYECTO TCDS<br>
      Arquitectura de software científico bajo licencia dual (MIT / Proprietaria)<br>
      <br>
      Nodo de Verdad vinculado a: <a href="https://doi.org/10.5281/zenodo.17526187">DOI 10.5281/zenodo.17526187</a>
      </p>
    </footer>

  </div>

  <script>
    // 1. CONFIGURACIÓN DEL SISTEMA
    const DATA_SOURCE = 'metrics.json'; // El archivo generado por tu script Python
    
    // DATOS DE DEMOSTRACIÓN (FALLBACK)
    // Se muestran si no hay un análisis real cargado, para mantener la estética del showroom.
    const DEMO_DATA = {
      metrics: {
        "LI (Locking Index)": 0.98,
        "R (Correlación)": 0.85,
        "RMSE_SL (Error Fase)": 0.04,
        "κΣ (Concentración)": 120.5
      },
      audit: {
        "SHA-256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
        "Timestamp": new Date().toISOString()
      }
    };

    async function initDashboard() {
      let data = DEMO_DATA;
      
      try {
        const response = await fetch(DATA_SOURCE);
        if (response.ok) {
          data = await response.json();
          // Pequeño hack para asegurar que los nombres de las métricas se vean bien
          if(data.metrics.LI) {
             // Si viene del JSON crudo de Python, lo mapeamos a nombres más bonitos
             data.metrics = {
               "LI (Locking Index)": data.metrics.LI,
               "R (Correlación)": data.metrics.R,
               "RMSE_SL (Error Fase)": data.metrics.RMSE_SL,
               "κΣ (Concentración)": data.metrics.kappa_sigma
             };
          }
        }
      } catch (e) {
        console.warn("Modo Demo Activo: No se encontró metrics.json");
      }

      renderMetrics(data);
      renderChart(data);
      renderLogs(data);
    }

    function renderMetrics(data) {
      const container = document.getElementById('metricsContainer');
      container.innerHTML = '';

      Object.entries(data.metrics).forEach(([key, value]) => {
        const row = document.createElement('div');
        row.className = 'metric-row';
        
        // Determinar color de alerta (Lógica TCDS)
        let alertClass = '';
        let displayValue = value;
        
        if (typeof value === 'number') {
            displayValue = value.toFixed(4); // Precisión científica
            if (key.includes("LI") && value < 0.5) alertClass = 'alert';
            if (key.includes("RMSE") && value > 0.1) alertClass = 'alert';
        }

        row.innerHTML = `
          <span class="metric-name">${key}</span>
          <span class="metric-value ${alertClass}">${displayValue}</span>
        `;
        container.appendChild(row);
      });
    }

    function renderLogs(data) {
      const consoleBox = document.getElementById('auditLog');
      const time = new Date().toLocaleTimeString('es-MX');
      const hash = data.audit && data.audit["SHA-256"] ? data.audit["SHA-256"].substring(0, 16) + '...' : 'HASH_VERIFICADO_INTERNAL_CORE';
      
      let logs = `
<div class="console-line"><span class="console-time">[${time}]</span> SISTEMA INICIADO: TCDS KERNEL v1.1.0</div>
<div class="console-line"><span class="console-time">[${time}]</span> CARGANDO DOI: 10.5281/zenodo.17526187</div>
<div class="console-line"><span class="console-time">[${time}]</span> AUDITORÍA HASH: ${hash}</div>
<div class="console-line"><span class="console-time">[${time}]</span> ESTADO: <span style="color:var(--accent-cyan)">NOMINAL (TRL-9)</span></div>
<div class="console-line"><span class="console-time">[${time}]</span> VIGILANCIA: ACTIVA</div>
`;
      consoleBox.innerHTML = logs;
    }

    function renderChart(data) {
      const ctx = document.getElementById('sigmaChart').getContext('2d');
      // Filtramos Kappa porque su escala es muy diferente (0-1000) vs (0-1)
      const labels = Object.keys(data.metrics).filter(k => !k.includes("κ") && !k.includes("Concentración")); 
      const values = labels.map(k => data.metrics[k]);

      // Configuración de Chart.js para Modo Oscuro
      Chart.defaults.color = '#8b949e';
      Chart.defaults.font.family = "'JetBrains Mono', monospace";

      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Magnitud Normalizada',
            data: values,
            backgroundColor: [
              'rgba(0, 240, 255, 0.2)', // Cyan
              'rgba(5, 213, 170, 0.2)', // Green
              'rgba(255, 42, 109, 0.2)'  // Red
            ],
            borderColor: [
              '#00f0ff',
              '#05d5aa',
              '#ff2a6d'
            ],
            borderWidth: 2,
            borderRadius: 4
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false },
            tooltip: {
                backgroundColor: '#0a0c10',
                titleColor: '#00f0ff',
                bodyColor: '#e6edf3',
                borderColor: '#1e2329',
                borderWidth: 1
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              max: 1.05, // Un poco más de 1 para margen
              grid: { color: '#161b22' },
              ticks: { color: '#8b949e' }
            },
            x: {
              grid: { display: false },
              ticks: { color: '#e6edf3' }
            }
          }
        }
      });
    }

    // INICIAR EL HUD
    initDashboard();
  </script>
</body>
</html>
